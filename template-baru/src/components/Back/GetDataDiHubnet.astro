---
import axios from "axios";
let dataHubnet: any = null;
try {
  const cookieHeader = Astro.request.headers.get("cookie") || "";
  const cookies = Object.fromEntries(
    cookieHeader.split(/; */).map(c => {
      const [key, ...v] = c.split("=");
      return [key, v.join("=")];
    })
  );
  const token = cookies["auth_token"];

  const apiInstance = axios.create({
    baseURL: import.meta.env.PUBLIC_BACKEND_PATH,
    headers: { Authorization: `Bearer ${token}`, "Content-Type": "application/json" }
  });
  const [hubnetData] = await Promise.all([
    apiInstance.get("/hubnet/get-data-terkirim/", {
      params: {
        flt_date: "2025-10-01",
        page: 1,
        per_page: 10
      }
    })
  ]);
  dataHubnet = hubnetData.data;
} catch (e) {
  console.log(e);
}
---

<div class='col-md'>
  <div class='card mb-4'>
    <div class='card-header header-elements'>
      <span class='me-2'>Card Header</span>

      <div class='card-header-elements ms-auto'>
        <input type='text' class='form-control form-control-sm' placeholder='Search' />
      </div>
    </div>
    <div class='card-body'>
      <div class='table-responsive text-nowrap'>
        <table class='table table-sm table-hover'>
          <thead class='table-light'>
            <tr>
              <th>AWB_NO</th>
              <th>FLT_NUMBER</th>
              <th>FLT_DATE</th>
              <th>ORI</th>
              <th>DEST</th>
              <th>T</th>
              <th>K</th>
              <th>CH_WEIGHT</th>
              <th>IS_INTERNATIONAL</th>
              <th>IS_EKSPOR</th>
            </tr>
          </thead>
          <tbody class='table-border-bottom-0'>
            {
              dataHubnet.data.map(item => (
                <tr>
                  <td>{item.AWB_NO}</td>
                  <td>{item.FLT_NUMBER}</td>
                  <td>{item.FLT_DATE}</td>
                  <td>{item.ORI}</td>
                  <td>{item.DEST}</td>
                  <td>{item.T}</td>
                  <td>{item.K}</td>
                  <td>{item.CH_WEIGHT}</td>
                  <td>
                    <span class='badge bg-label-info'>
                      {item.IS_INTERNATIONAL === 1 ? "INTERNATIONAL" : "DOMESTIK"}
                    </span>
                  </td>
                  <td>
                    <span class='badge bg-label-primary'>{item.IS_EKSPOR === 1 ? "EKSPORT" : "IMPORT"}</span>
                  </td>
                </tr>
              ))
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
